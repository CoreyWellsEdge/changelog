const fs = require('fs');
const path = require('path');
const moment = require('moment-timezone');

// Path to the changelog file generated by semantic-release
const changelogPath = path.join(process.cwd(), 'CHANGELOG.md');

// Read the changelog file
fs.readFile(changelogPath, 'utf8', (err, data) => {
  if (err) {
    console.error('Error reading changelog:', err);
    return;
  }

  // Regex to find the most recent release date (in UTC)
  const dateRegex = /(\d{4}-\d{2}-\d{2})/g;

  // Adjust the date to Brisbane timezone
  const updatedData = data.replace(dateRegex, (match) => {
    const date = moment.tz(match, 'YYYY-MM-DD', 'Australia/Brisbane');
    return date; // Replace with new date format
  });

  // Write the updated changelog back to the file
  fs.writeFile(changelogPath, updatedData, 'utf8', (err) => {
    if (err) {
      console.error('Error writing updated changelog:', err);
      return;
    }
    //console.log('Release date updated successfully in changelog!');
	
  });
});
